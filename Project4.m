% Zhuofei Xie
% 11/18/2019
% Professor: Michael Neilan 

function project4Template

clear;
clc; 

fh=@(x)exp(x)./(1+x.^4);


m=15;           %# nodes in gaussian quad rule.

[x,w] = getNodesWeights(m); %load gaussian quad. rule in vectors x and w

X=linspace(-1,1,200);    %create vector with equidistant nodes

N = length(X);  %N = size of vector X

n = 5;          %declare polynomial degree


Mna = ones(N,1); 
d = ones(m,1);
c = ones(n+1,1);
S = ones(n,1); 

for j = 1:n+1
    for i = 1:m
       P1  = legendre(j-1,x); 
       d(i) = w(i)*fh(x(i))*P1(1,i); 
    end 
    c(j) = (2*(j-1) + 1)*sum(d); 
end

for i = 1:N
    for j = 1:n+1
        P2  = legendre(j-1,X); 
        S(j) = c(j)*P2(1,i); 
    end
    Mna(i) = 0.5*sum(S);
end

error = fh(X) - Mna.'; 

max(abs(error))

fplot(fh, [-1,1])
hold on; 
plot(X,Mna)

end


function [x,w] = getNodesWeights(m)

x = zeros(m,1);
w = zeros(m,1);

switch m
    
    case 10
        w(1) = 0.2955242247147529;	x(1) = -0.1488743389816312;
        w(2) = 0.2955242247147529;	x(2) = 0.1488743389816312;
        w(3) = 0.2692667193099963;	x(3) = -0.4333953941292472;
        w(4) = 0.2692667193099963;	x(4) = 0.4333953941292472;
        w(5) = 0.2190863625159820;	x(5) = -0.6794095682990244;
        w(6) = 0.2190863625159820;	x(6) = 0.6794095682990244;
        w(7) = 0.1494513491505806;	x(7) = -0.8650633666889845;
        w(8) = 0.1494513491505806;	x(8) = 0.8650633666889845;
        w(9) = 0.0666713443086881;	x(9) = -0.9739065285171717;
        w(10) = 0.0666713443086881;	x(10) = 0.9739065285171717;
    case 15
        
        w(1) = 0.2025782419255613;	x(1) = 0.0000000000000000;
        w(2) = 0.1984314853271116;	x(2) = -0.2011940939974345;
        w(3) = 0.1984314853271116;	x(3) = 0.2011940939974345;
        w(4) = 0.1861610000155622;	x(4) = -0.3941513470775634;
        w(5) = 0.1861610000155622;	x(5) = 0.3941513470775634;
        w(6) = 0.1662692058169939;	x(6) = -0.5709721726085388;
        w(7) = 0.1662692058169939;	x(7) = 0.5709721726085388;
        w(8) = 0.1395706779261543;	x(8) = -0.7244177313601701;
        w(9) = 0.1395706779261543;	x(9) = 0.7244177313601701;
        w(10) = 0.1071592204671719;	x(10) = -0.8482065834104272;
        w(11) = 0.1071592204671719;	x(11) = 0.8482065834104272;
        w(12) = 0.0703660474881081;	x(12) = -0.9372733924007060;
        w(13) = 0.0703660474881081;	x(13) = 0.9372733924007060;
        w(14) = 0.0307532419961173;	x(14) = -0.9879925180204854;
        w(15) = 0.0307532419961173;	x(15) = 0.9879925180204854;
        
    otherwise
        error('Gaussian quad rule not supported.');
end

end

